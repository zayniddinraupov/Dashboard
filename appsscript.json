function doGet(e) {
  let action = e.parameter.action;
  
  if (action === "get") {
    let sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Data");
    if (!sheet) return ContentService.createTextOutput("{}");
    let data = sheet.getRange("A1").getValue();
    return ContentService.createTextOutput(data || "{}").setMimeType(ContentService.MimeType.JSON);
  }
  
  if (action === "set") {
    let data = e.parameter.data;
    let sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Data");
    if (!sheet) {
      sheet = SpreadsheetApp.getActiveSpreadsheet().insertSheet("Data");
    }
    sheet.getRange("A1").setValue(data);
    return ContentService.createTextOutput("OK");
  }
  
  return ContentService.createHtmlOutput("HR API Ready");
}
